---
title: "2023 Summative Assessment"
author: "Lesley Mitchell (2223232)"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(
  echo       = FALSE,    # whether to show code chunks
  message    = FALSE,    # whether to show messages from your code
  warning    = FALSE,    # whether to show warnings from your code
  fig.width  = 8,        # figure width in inches (at 96 dpi)
  fig.height = 5,        # figure height in inches (at 96 dpi)
  fig.align  = "center", # align figures to centre of page
  out.width = "90%"      # figures/images span 90% of the page width
)

# Load libraries
library(tidyverse)
library(conflicted)   # makes conflicts between tidyverse and other packages explicit
library(kableExtra)
library(ggthemes)
library(viridisLite)  # for colourblind friendly colour palates
library(forcats)      # useful factor tools
library(scales)       # useful number formatting tools (e.g. adding commas, scaling, displaying currency)

# Set plot theme
theme_set(theme_stata()) # default theme for plots

```

```{r file-import }

owid_energy <- read_csv("data/owid-energy-data.csv")

elec_access <- read_csv("data/number-of-people-with-and-without-electricity-access.csv")

```

## Which energy source has generated the highest amount of electricity worldwide over time?

```{r highest-all-time-electricity-production }

# Averaging across time, which is the energy source (e.g. fossil fuels, nuclear power, and
# renewables) that generates the highest amount of electricity worldwide. How much
# electricity has been generated from each of these sources?

# OWID Energy Data is huge, first, trim to the useful columns:
# fossil_electricity (all of coal, oil and gas)
# nuclear_electricity
# renewables_electricity (all renewable sources, inc. solar, wind, biofuels and other)

dfTotalElectricityOverTimeBySource <- owid_energy %>%
  select(fossil_electricity, nuclear_electricity, renewables_electricity) %>%
  summarise(Fossil = sum(fossil_electricity, na.rm = TRUE),
            Nuclear = sum(nuclear_electricity, na.rm = TRUE),
            Renewables = sum(renewables_electricity, na.rm = TRUE)) %>%
  pivot_longer(everything(), names_to = "source", values_to = "production") %>%
  arrange(desc(production))

```

```{r highest-all-time-electricity-production-graph }

# For tidiness, order the columns highest to lowest value
# fct_reorder orders source by ascending values in production
# fct_rev reverses this order

ggplot(dfTotalElectricityOverTimeBySource, mapping = aes(x = fct_rev(fct_reorder(source, production)),
                                                         y = production)) +
  geom_col(fill = "lightblue") +
  labs(title = "Total global electricity generated by source",
       subtitle = "Across all time",
       caption = "TWh = terawatt-hours (1,000,000MWh)",
       alt = "Column graph with three columns in highest to lowest order, left to right. Largest column is for fossil fuels, middle column is for renewables, smallest column is for nuclear.") +
  xlab(NULL) +
  ylab("Total electricity produced (TWh)") +
  # Legibility fixes
  # Add commas to the y axis values
  scale_y_continuous(labels = unit_format(unit = "K", scale = 1e-4, sep = "")) +
  # Rotate the tick values on the y axis
  theme(axis.text.y = element_text(angle = 0))

```

## Primary energy consumption changed across time

```{r energy-consumption-over-time }

# How has primary energy consumption (in terawatt-hours) changed worldwide across time?
# What are the key trends?



```

